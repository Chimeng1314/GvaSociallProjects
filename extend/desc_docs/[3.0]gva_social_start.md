# 【Swagger】

## 【1】文档官网

- https://github.com/swaggo/swag/blob/master/README_zh-CN.md

## 【2】安装步骤

- 可以翻墙

```shell
go install github.com/swaggo/swag/cmd/swag@version
```

- 无法翻墙 由于国内没法安装 [go.org/x](http://go.org/x) 包下面的东西，推荐使用 [goproxy.cn](https://goproxy.cn/zh/)
  或者 [goproxy.cn/](https://goproxy.cn/)

```shell
# Go 版本 是 1.16 ~ 最新版 可以忽略以下步骤一
# 步骤一、启用 Go Modules 功能
go env -w GO111MODULE=on 
# 步骤二、配置 GOPROXY 环境变量
go env -w GOPROXY=https://goproxy.cn,direct

# 使用如下命令下载swag
go install github.com/swaggo/swag/cmd/swag@version
```

## 【3】生成API文档[#](https://www.gin-vue-admin.com/guide/start-quickly/swagger.html#_2-生成api文档)

```shell
cd server
swag init
```

- 执行上面的命令后，server目录下会出现docs文件夹，打开浏览器复制如下地址，即可查看swagger文档

```ini
http://localhost:8888/swagger/index.html
```

## 【4】错误处理

```sh
## 如果不行，获取更新包：
go get github.com/swaggo/echo-swagger

##以上还是不行，在更新
go get github.com/alecthomas/template
```

# 【一】GVA开发流程

- gva已经提供一个基础的系统架构和开发很多后台项目管理的一些基础功能。
- 我们只需要把我们的业务和相关模块进行二次开发即可。
- 就可以形成一个完整的关于你自己的后台管理系统。

# 【二】GVA整体的项目架构分析

## 【1】前后端开发本质

### （1）服务端（写接口）

- **路由定义**：访问某个模块的数据时，需要查看表结构。
- **使用`gorm`进行数据库操作**：`gorm`用于映射`Go`语言的结构体与数据库表之间的关系。
- **返回查询结果**：查询到的数据通过接口返回给客户端。

### （2）客户端（调接口）

- **发起请求**：客户端根据服务端提供的接口路由发起请求。
- **`ginserver`处理请求**：`ginserver`接收客户端请求，获取参数并执行路由对应的处理方法。
- **返回数据**：接口执行后，返回路由定义模块的数据。

## 【2】GVA项目架构分析

### （1）GVA框架简介

GVA是一个搭建好的项目框架，提供了清晰的架构和模块划分，开发者在此基础上快速构建自己的应用。主要组成包括：

- **Gin**：用于提供Web服务，监听端口（如8888），并处理路由请求。
- **Gorm**：用于数据库持久化层操作，包括CRUD（增删改查）和分页等。
- **API接口**：用于暴露服务端接口给客户端调用。
- **Docs（Swagger）**：提供API文档，开发者可以通过Swagger生成接口文档。
- **Global**：存放全局配置和变量，方便在各个模块中进行访问。
- **Middleware**：用于统一处理路由拦截器，如鉴权、权限校验等。
- **Model**：用于定义数据库表与Go语言结构体之间的映射。
- **Router**：负责路由的注册和接口的对外暴露。
- **Service**：包含具体的业务逻辑，提供CURD操作供API调用。
- **Source**：用于数据初始化，例如数据库的初始数据导入。
- **Utils**：工具类模块，包含常用的工具函数。
- **Resource**：代码自动生成的模块。

### （2）关键技术组件分析

#### [1] Gin（Web框架）

- **端口监听**：Gin作为Web服务框架，默认监听端口（如8888）。
- **路由定义**：通过Gin框架定义路由，模块间通过路由访问各自的数据。
    - 示例：`user/list`, `user/get`, `user/save`, `user/update`, `user/delete`等。
    - 示例：`course/list`, `course/get`, `course/save`, `course/update`, `course/delete`等。
- **中间件配置**：路由配置可以使用中间件来进行统一的请求拦截处理。
    - 示例：鉴权、日志记录、权限校验等。

- **命名空间（路由组）**：通过路由组来组织模块。
    - `PrivateRouterGroup`：一个包含多个模块的路由组，内部包含多个子路由，如`userRouterGroup`和`courseRouterGroup`。

- **参数获取**：
    - **单参数**：例如，`/user/get?id=1&name=zhangsan`。
    - **对象参数**：通过`POST`请求获取JSON对象，`body {id:1, name:"zhangsan"}`。
    - **路径参数**：例如，`/user/get/1/zhangsan`。

- **返回值格式**：统一的返回格式（例如`VO`）用于接口返回，保证一致性。

#### [2] Gorm（ORM框架）

- **持久化层框架**：Gorm用于执行数据库的CRUD操作。开发者应熟悉Gorm的基本操作，如插入、查询、更新、删除等。
- **表结构映射**：Gorm将数据库中的表映射到Go结构体中，操作结构体即可操作数据库。

#### [3] API接口

- **暴露接口**：服务端通过API接口暴露功能，供客户端进行调用。

#### [4] Docs（Swagger）

- **Swagger集成**：用于生成接口文档，开发者可以通过Swagger命令生成`doc.go`文件，从而暴露接口文档。

#### [5] Global（全局配置）

- **全局变量和配置**：在`global`包中定义一些全局变量，例如数据库连接、Redis连接、日志实例、配置文件等。这样，任何模块都可以通过
  `global`包访问这些全局资源。

  示例代码：
  ```go
  package global
  import (
      "sync"
      "github.com/flipped-aurora/gin-vue-admin/server/utils/timer"
      "github.com/songzhibin97/gkit/cache/local_cache"
      "github.com/spf13/viper"
      "gorm.io/gorm"
      "go.uber.org/zap"
      "github.com/go-redis/redis/v8"
      "github.com/flipped-aurora/gin-vue-admin/server/config"
  )
  
  var (
      GVA_DB     *gorm.DB
      GVA_DBList map[string]*gorm.DB
      GVA_REDIS  *redis.Client
      GVA_CONFIG config.Server
      GVA_VP     *viper.Viper
      GVA_LOG    *zap.Logger
      GVA_Timer  timer.Timer = timer.NewTimerTask()
      GVA_Concurrency_Control = &singleflight.Group{}
      BlackCache local_cache.Cache
      lock       sync.RWMutex
  )
  
  func GetGlobalDBByDBName(dbname string) *gorm.DB {
      lock.RLock()
      defer lock.RUnlock()
      return GVA_DBList[dbname]
  }
  
  func MustGetGlobalDBByDBName(dbname string) *gorm.DB {
      lock.RLock()
      defer lock.RUnlock()
      db, ok := GVA_DBList[dbname]
      if !ok || db == nil {
          panic("db not initialized")
      }
      return db
  }
  ```

#### [6] Initialize（初始化）

- **系统初始化**：所有的服务、数据库连接、日志、缓存等的初始化都在`initialize`模块中完成。初始化的过程通常由`main`函数或
  `init`函数驱动，确保系统在启动时所有资源都已经准备好。

#### [7] Middleware（中间件）

- **请求处理拦截**：Gin中的中间件用于处理路由前的统一拦截，例如鉴权、权限校验、日志记录等。
- **JWT鉴权**：使用JWT中间件来进行用户身份验证。
- **Casbin权限控制**：通过Casbin中间件进行权限控制，确保不同角色拥有不同的权限。

#### [8] Model（数据模型）

- **数据库表结构映射**：在`model`中定义数据库表与Go语言结构体之间的映射关系。
- **业务数据模型**：每个模块的数据模型通常包括结构体定义、字段标签等。

#### [9] Router（路由）

- **路由配置**：通过`router`包将业务接口与路由进行绑定，对外暴露API接口。

#### [10] Service（业务服务层）

- **提供业务逻辑**：`service`层封装了所有业务逻辑，提供CURD操作给`api`层调用，确保业务层和接口层的解耦。

#### [11] Source（数据源）

- **初始化数据**：在应用启动时，`source`模块通常用于初始化数据，例如导入初始数据或执行数据库迁移。

#### [12] Utils（工具类）

- **工具函数**：`utils`包通常包含一些常用的工具函数，如加密、解密、日期格式化、日志处理等。

#### [13] Resource（资源模块）

- **代码生成**：自动构建的模块，通常用于代码的生成，减少开发者的重复性工作。

# 【三】开发文章模块示例

## 【1】数据库初始化

- 新建一个表模型
    - 利用框架自动创建
    - 自己通过 SQL / Navicat 手动创建 然后再映射

### （1）定义Model

#### [1]创建表规则

- 在创建表时应该遵循一下规则
    - 使用合理的字段类型对字段进行约束
    - 使用合理的命令创建对应的字段
    - 字段类型尽量不要使用 `null` 类型 以免造成索引失效
    - 状态列建议给默认值，尽量不要为空
    - 在创建字段时建议添加必要的注释

#### [2]gorm字段语法

- 官网：https://gorm.io/zh_CN/docs/index.html

| 标签名                    | 说明                                                                                                                                                                                                                                       |
|:-----------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| column                 | 指定 db 列名                                                                                                                                                                                                                                 |
| type                   | 列数据类型，推荐使用兼容性好的通用类型，例如：所有数据库都支持 bool、int、uint、float、string、time、bytes 并且可以和其他标签一起使用，例如：`not null`、`size`, `autoIncrement`… 像 `varbinary(8)` 这样指定数据库数据类型也是支持的。在使用指定数据库数据类型时，它需要是完整的数据库数据类型，如：`MEDIUMINT UNSIGNED not NULL AUTO_INCREMENT` |
| serializer             | 指定将数据序列化或反序列化到数据库中的序列化器, 例如: `serializer:json/gob/unixtime`                                                                                                                                                                              |
| size                   | 定义列数据类型的大小或长度，例如 `size: 256`                                                                                                                                                                                                             |
| primaryKey             | 将列定义为主键                                                                                                                                                                                                                                  |
| unique                 | 将列定义为唯一键                                                                                                                                                                                                                                 |
| default                | 定义列的默认值                                                                                                                                                                                                                                  |
| precision              | 指定列的精度                                                                                                                                                                                                                                   |
| scale                  | 指定列大小                                                                                                                                                                                                                                    |
| not null               | 指定列为 NOT NULL                                                                                                                                                                                                                            |
| autoIncrement          | 指定列为自动增长                                                                                                                                                                                                                                 |
| autoIncrementIncrement | 自动步长，控制连续记录之间的间隔                                                                                                                                                                                                                         |
| embedded               | 嵌套字段                                                                                                                                                                                                                                     |
| embeddedPrefix         | 嵌入字段的列名前缀                                                                                                                                                                                                                                |
| autoCreateTime         | 创建时追踪当前时间，对于 `int` 字段，它会追踪时间戳秒数，您可以使用 `nano`/`milli` 来追踪纳秒、毫秒时间戳，例如：`autoCreateTime:nano`                                                                                                                                                |
| autoUpdateTime         | 创建/更新时追踪当前时间，对于 `int` 字段，它会追踪时间戳秒数，您可以使用 `nano`/`milli` 来追踪纳秒、毫秒时间戳，例如：`autoUpdateTime:milli`                                                                                                                                            |
| index                  | 根据参数创建索引，多个字段使用相同的名称则创建复合索引，查看 [索引](https://gorm.io/zh_CN/docs/indexes.html) 获取详情                                                                                                                                                        |
| uniqueIndex            | 与 `index` 相同，但创建的是唯一索引                                                                                                                                                                                                                   |
| check                  | 创建检查约束，例如 `check:age > 13`，查看 [约束](https://gorm.io/zh_CN/docs/constraints.html) 获取详情                                                                                                                                                     |
| <-                     | 设置字段写入的权限， `<-:create` 只创建、`<-:update` 只更新、`<-:false` 无写入权限、`<-` 创建和更新权限                                                                                                                                                                 |
| ->                     | 设置字段读的权限，`->:false` 无读权限                                                                                                                                                                                                                 |
| -                      | 忽略该字段，`-` 表示无读写，`-:migration` 表示无迁移权限，`-:all` 表示无读写迁移权限                                                                                                                                                                                  |
| comment                | 迁移时为字段添加注释                                                                                                                                                                                                                               |

#### [3]公共表模型修改

```go
package global

import (
	"time"

	"gorm.io/gorm"
)

type GVA_MODEL struct {
	ID        uint           `gorm:"primarykey;comment:主键ID" json:"id" form:"id"`      // 主键ID
	CreatedAt time.Time      `gorm:"AUTO_CREATED_AT;comment :创建时间" json:"createdAt"` // 创建时间
	UpdatedAt time.Time      `gorm:"AUTO_UPDATED_AT;comment :更新时间" json:"updatedAt"` // 更新时间
	DeletedAt gorm.DeletedAt `gorm:"index;comment :删除时间" json:"-"`                   // 删除时间
}

//ID 是用来给当前的Go程序去使用和调用的，大写的原因是私有变量
// 请求入参 会映射 model 的属性
// form 参数是用来约束入参(查询)的格式的 json 是用来约束出参的格式的

```

#### [4]表模型示例

- `model/bbs/article_model.go` 定义文章表模型

```go
package bbs

import "github.com/flipped-aurora/gin-vue-admin/server/global"

// Article 文章表模型结构体
type Article struct {
	// 继承全局 公共字段
	global.GVA_MODEL
	Title        string `json:"title" gorm:"not null;index;comment :标题"`
	Img          string `json:"img" gorm:"not null;comment : 封面图"`
	Description  string `json:"description" gorm:"not null;comment : 描述"`
	Content      string `json:"content" gorm:"not null;comment : 文章内容 -- MD 格式"`
	HtmlContent  string `json:"htmlContent" gorm:"not null;comment : html内容 -- MD格式"`
	CategoryId   uint   `json:"categoryId" gorm:"not null;comment : 分类ID"`
	CategoryName string `json:"categoryName" gorm:"not null;comment : 分类名称"`
	ViewCount    uint   `json:"viewCount" gorm:"not null;comment : 浏览量"`
	Comments     uint   `json:"comments" gorm:"not null;comment : 评论数"`
	CommentsOpen bool   `json:"commentsOpen" gorm:"not null;default:1;comment : 是否开启评论 0 未开启 1 已开启"`
	Status       bool   `json:"status" gorm:"not null;default:0;comment : 是否发布 0 未发布 1 已发布"`
	IsDelete     bool   `json:"isDelete" gorm:"not null;default:0;comment : 是否删除 0 未删除 1 已删除"`
	UserId       uint   `json:"userId" gorm:"not null;comment : 文章发布者ID"`
	UserName     string `json:"userName" gorm:"not null;comment : 文章发布者用户名"`
	UserAvatar   string `json:"userAvatar" gorm:"not null;comment : 文章发布者头像"`
}

// TableName 定义Article结构体的方法，返回表名
func (Article) TableName() string {
	// 返回字符串"bbs_article"作为表名
	return "bbs_article"
}

```

### （2）注册模型表

- `initialize/gorm.go` 注册新创建的表模型

```go
package initialize

import (
	"github.com/flipped-aurora/gin-vue-admin/server/model/bbs"
	"os"

	"github.com/flipped-aurora/gin-vue-admin/server/global"
	"github.com/flipped-aurora/gin-vue-admin/server/model/example"
	"github.com/flipped-aurora/gin-vue-admin/server/model/system"

	"go.uber.org/zap"
	"gorm.io/gorm"
)

func Gorm() *gorm.DB {
	switch global.GVA_CONFIG.System.DbType {
	case "mysql":
		global.GVA_ACTIVE_DBNAME = &global.GVA_CONFIG.Mysql.Dbname
		return GormMysql()
	case "pgsql":
		global.GVA_ACTIVE_DBNAME = &global.GVA_CONFIG.Pgsql.Dbname
		return GormPgSql()
	case "oracle":
		global.GVA_ACTIVE_DBNAME = &global.GVA_CONFIG.Oracle.Dbname
		return GormOracle()
	case "mssql":
		global.GVA_ACTIVE_DBNAME = &global.GVA_CONFIG.Mssql.Dbname
		return GormMssql()
	case "sqlite":
		global.GVA_ACTIVE_DBNAME = &global.GVA_CONFIG.Sqlite.Dbname
		return GormSqlite()
	default:
		global.GVA_ACTIVE_DBNAME = &global.GVA_CONFIG.Mysql.Dbname
		return GormMysql()
	}
}

func RegisterTables() {
	db := global.GVA_DB
	err := db.AutoMigrate(

		system.SysApi{},
		system.SysIgnoreApi{},
		system.SysUser{},
		system.SysBaseMenu{},
		system.JwtBlacklist{},
		system.SysAuthority{},
		system.SysDictionary{},
		system.SysOperationRecord{},
		system.SysAutoCodeHistory{},
		system.SysDictionaryDetail{},
		system.SysBaseMenuParameter{},
		system.SysBaseMenuBtn{},
		system.SysAuthorityBtn{},
		system.SysAutoCodePackage{},
		system.SysExportTemplate{},
		system.Condition{},
		system.JoinTemplate{},
		system.SysParams{},

		example.ExaFile{},
		example.ExaCustomer{},
		example.ExaFileChunk{},
		example.ExaFileUploadAndDownload{},

		// 注册我们自己创建的表模型
		bbs.Article{},
	)
	if err != nil {
		global.GVA_LOG.Error("register table failed", zap.Error(err))
		os.Exit(0)
	}

	err = bizModel()

	if err != nil {
		global.GVA_LOG.Error("register biz_table failed", zap.Error(err))
		os.Exit(0)
	}
	global.GVA_LOG.Info("register table success")
}
```

### （3）数据库补充

- 在创建好的模型表 model 里面修改某个字段的类型 ，在重启项目时并不会修改对应字段的类型
- 在创建好的模型表 model 里面新增某个字段和其对应的类型 ，在重启项目时会自动创建对应的字段
- 在创建好的模型表 model 里面删除某个已经存在的字段后 ，在重启项目时不会自动删除对应字段

## 【2】服务层注册

- `service/bbs/article_service.go` 注册 文章表 服务层
- 对当前 模型表 结构体 做增删改查操作 (Create 创建 Update 更新 Read 查询 Drop 删除)
- 目的是为了使用 gorm 框架将数据映射到 go 语言的结构体中

```go
package bbs

import (
	"github.com/flipped-aurora/gin-vue-admin/server/global"
	"github.com/flipped-aurora/gin-vue-admin/server/model/bbs"
	"github.com/flipped-aurora/gin-vue-admin/server/model/common/request"
	"github.com/flipped-aurora/gin-vue-admin/server/model/example"
)

// ArticleService 定义结构体 , 为 BBS 数据库 的Article 表 提供 CURD 服务
type ArticleService struct {
}

// CreateArticle 创建方法 -- 如果一个方法被 BbsServiceGroup 限定死 只能让 BbsServiceGroup 的实例 来调用 CreateArticle 方法
// @author: Dream
// @function : CreateArticle
// @description : 创建文章数据
// @param : bbs.Article
// @return : error
func (bbsArticle *ArticleService) CreateArticle(article *bbs.Article) error {

	// 【1】获取数据库的链接对象
	err := global.GVA_DB.Create(article).Error
	if err != nil {
		return err
	}

	return nil
}

//@author: Dream
//@function: UpdateArticle
//@description: 更新文章信息
//@param: e bbs.Article
//@return: err error

func (bbsArticle *ArticleService) UpdateArticle(article *bbs.Article) (err error) {
	err = global.GVA_DB.Save(article).Error
	return err
}

//@author: Dream
//@function: DeleteArticle
//@description: 删除文章对象
//@param: e bbs.Article
//@return: err error

func (bbsArticle *ArticleService) DeleteArticle(article *bbs.Article) (err error) {
	err = global.GVA_DB.Delete(article).Error
	return err
}

//@author: Dream
//@function: GetArticle
//@description: 根据 id 获取文章信息
//@param: id uint
//@return: article bbs.Article, err error

func (bbsArticle *ArticleService) GetArticle(id uint) (article *bbs.Article, err error) {
	err = global.GVA_DB.Where("id = ?", id).First(&article).Error
	return
}

//@author: Dream
//@function: GetArticleInfoList
//@description: 分页获取客户列表
//@param: sysUserAuthorityID string, info request.PageInfo
//@return: list interface{}, total int64, err error

func (bbsArticle *ArticleService) GetArticleInfoList(info request.PageInfo) (list interface{}, total int64, err error) {
	limit := info.PageSize
	offset := info.PageSize * (info.Page - 1)
	db := global.GVA_DB.Model(&bbs.Article{})

	var ArticleList []example.ExaCustomer
	err = db.Count(&total).Error
	if err != nil {
		return ArticleList, total, err
	} else {
		err = db.Limit(limit).Offset(offset).Find(&ArticleList).Error
	}
	return ArticleList, total, err
}
```

## 【3】路由层注册

- `api/v1/bbs/article_controller.go` 定义路由

```go
package bbsapi

import (
	"github.com/flipped-aurora/gin-vue-admin/server/global"
	"github.com/flipped-aurora/gin-vue-admin/server/model/bbs"
	"github.com/flipped-aurora/gin-vue-admin/server/model/common/response"
	bbsService "github.com/flipped-aurora/gin-vue-admin/server/service/bbs"
	"github.com/flipped-aurora/gin-vue-admin/server/utils"
	"github.com/gin-gonic/gin"
	"go.uber.org/zap"
)

type ArticleApi struct{}

// GetArticle
// @Tags      GetArticle
// @Summary   根据文章ID查询文章详情信息
// @Security  ApiKeyAuth
// @accept    application/json
// @Produce   application/json
// @Param     data  query     bbsapi.GetArticle                                                true  "客户ID"
// @Success   200   {object}  response.Response{data=data,msg=string}  "获取单一客户信息,返回包括客户详情"
// @Router    /article/get?id=1 [get]
func (a *ArticleApi) GetArticle(c *gin.Context) {
	var articleObj bbs.Article
	err := c.ShouldBindQuery(&articleObj)
	if err != nil {
		response.FailWithMessage(err.Error(), c)
		return
	}
	err = utils.Verify(articleObj.GVA_MODEL, utils.IdVerify)
	if err != nil {
		response.FailWithMessage(err.Error(), c)
		return
	}
	bbsService := new(bbsService.ArticleService)
	data, err := bbsService.GetArticle(articleObj.ID)
	if err != nil {
		global.GVA_LOG.Error("获取失败!", zap.Error(err))
		response.FailWithMessage("获取失败", c)
		return
	}
	response.OkWithDetailed(data, "获取成功", c)
}
```

- `router/bbs/bbs_router.go`

```go
package bbsrouter

import (
	bbsapi "github.com/flipped-aurora/gin-vue-admin/server/api/v1/bbs"
	"github.com/gin-gonic/gin"
)

type ArticleRouter struct{}

func (a *ArticleRouter) InitArticleRouter(Router *gin.RouterGroup) {
	//articleRouter := Router.Group("article").Use(middleware.OperationRecord())
	//{
	//	customerRouter.POST("customer", exaCustomerApi.CreateExaCustomer)   // 创建客户
	//	customerRouter.PUT("customer", exaCustomerApi.UpdateExaCustomer)    // 更新客户
	//	customerRouter.DELETE("customer", exaCustomerApi.DeleteExaCustomer) // 删除客户
	//}

	articleRouterWithoutRecord := Router.Group("article")
	articleApi := new(bbsapi.ArticleApi)
	{
		// 定义一个查询路由的方法
		articleRouterWithoutRecord.GET("article", articleApi.GetArticle) // 获取单一客户信息
		//customerRouterWithoutRecord.GET("customerList", exaCustomerApi.GetExaCustomerList) // 获取客户列表
	}
}

```

- [`initialize/router.go` 初始化路由](../../initialize/router.go)

```go
package initialize

import (
	bbsrouter "github.com/flipped-aurora/gin-vue-admin/server/router/bbs"
	"net/http"
	"os"

	"github.com/flipped-aurora/gin-vue-admin/server/docs"
	"github.com/flipped-aurora/gin-vue-admin/server/global"
	"github.com/flipped-aurora/gin-vue-admin/server/middleware"
	"github.com/flipped-aurora/gin-vue-admin/server/router"
	"github.com/gin-gonic/gin"
	swaggerFiles "github.com/swaggo/files"
	ginSwagger "github.com/swaggo/gin-swagger"
)

type justFilesFilesystem struct {
	fs http.FileSystem
}

func (fs justFilesFilesystem) Open(name string) (http.File, error) {
	f, err := fs.fs.Open(name)
	if err != nil {
		return nil, err
	}

	stat, err := f.Stat()
	if stat.IsDir() {
		return nil, os.ErrPermission
	}

	return f, nil
}

// 初始化总路由

func Routers() *gin.Engine {
	Router := gin.New()
	Router.Use(gin.Recovery())
	if gin.Mode() == gin.DebugMode {
		Router.Use(gin.Logger())
	}

	systemRouter := router.RouterGroupApp.System
	exampleRouter := router.RouterGroupApp.Example
	// 注册路由对象
	articleRouter := new(bbsrouter.ArticleRouter)
	// 如果想要不使用nginx代理前端网页，可以修改 web/.env.production 下的
	// VUE_APP_BASE_API = /
	// VUE_APP_BASE_PATH = http://localhost
	// 然后执行打包命令 npm run build。在打开下面3行注释
	// Router.Static("/favicon.ico", "./dist/favicon.ico")
	// Router.Static("/assets", "./dist/assets")   // dist里面的静态资源
	// Router.StaticFile("/", "./dist/index.html") // 前端网页入口页面

	Router.StaticFS(global.GVA_CONFIG.Local.StorePath, justFilesFilesystem{http.Dir(global.GVA_CONFIG.Local.StorePath)}) // Router.Use(middleware.LoadTls())  // 如果需要使用https 请打开此中间件 然后前往 core/server.go 将启动模式 更变为 Router.RunTLS("端口","你的cre/pem文件","你的key文件")
	// 跨域，如需跨域可以打开下面的注释
	// Router.Use(middleware.Cors()) // 直接放行全部跨域请求
	// Router.Use(middleware.CorsByRules()) // 按照配置的规则放行跨域请求
	// global.GVA_LOG.Info("use middleware cors")
	docs.SwaggerInfo.BasePath = global.GVA_CONFIG.System.RouterPrefix
	Router.GET(global.GVA_CONFIG.System.RouterPrefix+"/swagger/*any", ginSwagger.WrapHandler(swaggerFiles.Handler))
	global.GVA_LOG.Info("register swagger handler")
	// 方便统一添加路由组前缀 多服务器上线使用

	PublicGroup := Router.Group(global.GVA_CONFIG.System.RouterPrefix)
	PrivateGroup := Router.Group(global.GVA_CONFIG.System.RouterPrefix)

	PrivateGroup.Use(middleware.JWTAuth()).Use(middleware.CasbinHandler())

	{
		// 健康监测
		PublicGroup.GET("/health", func(c *gin.Context) {
			c.JSON(http.StatusOK, "ok")
		})
	}
	{
		systemRouter.InitBaseRouter(PublicGroup) // 注册基础功能路由 不做鉴权
		systemRouter.InitInitRouter(PublicGroup) // 自动初始化相关
	}
	{
		// 注册路由并 开放 公共权限
		articleRouter.InitArticleRouter(PublicGroup)
	}
	{
		systemRouter.InitApiRouter(PrivateGroup, PublicGroup)       // 注册功能api路由
		systemRouter.InitJwtRouter(PrivateGroup)                    // jwt相关路由
		systemRouter.InitUserRouter(PrivateGroup)                   // 注册用户路由
		systemRouter.InitMenuRouter(PrivateGroup)                   // 注册menu路由
		systemRouter.InitSystemRouter(PrivateGroup)                 // system相关路由
		systemRouter.InitCasbinRouter(PrivateGroup)                 // 权限相关路由
		systemRouter.InitAutoCodeRouter(PrivateGroup, PublicGroup)  // 创建自动化代码
		systemRouter.InitAuthorityRouter(PrivateGroup)              // 注册角色路由
		systemRouter.InitSysDictionaryRouter(PrivateGroup)          // 字典管理
		systemRouter.InitAutoCodeHistoryRouter(PrivateGroup)        // 自动化代码历史
		systemRouter.InitSysOperationRecordRouter(PrivateGroup)     // 操作记录
		systemRouter.InitSysDictionaryDetailRouter(PrivateGroup)    // 字典详情管理
		systemRouter.InitAuthorityBtnRouterRouter(PrivateGroup)     // 按钮权限管理
		systemRouter.InitSysExportTemplateRouter(PrivateGroup)      // 导出模板
		systemRouter.InitSysParamsRouter(PrivateGroup, PublicGroup) // 参数管理
		exampleRouter.InitCustomerRouter(PrivateGroup)              // 客户路由
		exampleRouter.InitFileUploadAndDownloadRouter(PrivateGroup) // 文件上传下载功能路由

	}

	//插件路由安装
	InstallPlugin(PrivateGroup, PublicGroup, Router)

	// 注册业务路由
	initBizRouter(PrivateGroup, PublicGroup)

	global.GVA_ROUTERS = Router.Routes()

	global.GVA_LOG.Info("router register success")
	return Router
}
```